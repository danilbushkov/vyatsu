%! TEX TS-program = xelatex
\documentclass[a4paper,10pt]{article}
\usepackage{geometry}
\usepackage{lipsum}
\usepackage{fancyhdr}
\usepackage[russian, english]{babel}
\usepackage{fontspec}
\usepackage{setspace}
\usepackage{ulem}
\usepackage{indentfirst}

\setmainfont{Times New Roman}
\input{./frames.tex}
\input{./toc.tex}
\input{./titlestyle.tex}
\input{./constants.tex}
%\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\geometry{top = 15mm, left = 25mm, right = 10mm, bottom = 15mm}

\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{mainframe} {
    \fancyhf{}
    \fancyhead[L]{
        \mainframe
        {\tpga}
        {Кафедра ЭВМ Группа ИВТ-41}{
        \topic
        }
        {\authori}
        {Долженкова}
        {Скворцов}
        {Долженкова}
        {\thepage}
        {\pageref{lastpage}}
    }

}
\fancypagestyle{pageframe} {
    \fancyhf{}
    \fancyhead[L]{
        \pageframe
        {\tpga}
        {\thepage}
    }
}

\onehalfspacing
\setlength{\parindent}{12.5mm}

\newcommand{\csection}[1]{
\section*{\hfill #1 \hfill}
\addcontentsline{toc}{section}{#1}
}

\begin{document}
\renewcommand{\contentsname}{\hfill Содержание \hfill}
\Large
\pagestyle{empty}
\include{pages/title.tex}

\include{pages/abstract.tex}

\addtolength{\textheight}{-40mm}
\tocloftpagestyle{mainframe}
\pagestyle{pageframe}
\addtolength{\textheight}{+25mm}
\tableofcontents\newpage

\csection{Введение}
asdfjasdlfkjaslkdfjlaksdj
\lipsum[6-20]
%\subsection{Привет}
%\section{Часть 1}
%
%\section{Часть 2}
%\subsection{Привет}
%\section{Часть 1}
%
%\section{Часть 2}
%\section{Введение}
%\subsection{Привет}
%\section{Часть 1}
%
%\section{Часть 2}
%\section{Введение}
%\subsection{Привет}
%\section{Часть 1}
%
%\section{Часть 2}
%\subsection{Привет}
%asl;dkfskadf;
%\section{Часть 1}
%
%\section{Часть 2}
%las;dfkl;sdakf;
%\subsection{Привет}
%a;slkdf;lskd;flk
%\section{Часть 1}
%as;ldjf;lsadkf;
%\section{Часть 2}
%asljkdflk;dsajfl
%\subsection{Привет}
%\hspace{0pt}
%sdlfkjaslkdjflkasdjf
%
%asdfasdfasfd
%
%\section{Часть 1}
%
\section{Часть 2 часть 2 часть 2 часть 2 часть 2 часть 2 часть 2 часть 2 часть 22 часть 2 часть 2 часть 2}
asdfsdf

sdfgsdg

\subsection{123123}
%\hspace{0pt}

sdsadfas

asdfjaslk

\section{Часть 1}
\subsection{\lipsum[1]}
%\lipsum[6-20]

\section{Часть 2}

\label{lastpage}
\end{document}
