%! TEX TS-program = xelatex
\documentclass[a4paper,10pt]{article}
\usepackage{geometry}
\usepackage{lipsum}
\usepackage{fancyhdr}
\usepackage{fontspec}
\usepackage{setspace}
\usepackage{ulem}
\usepackage{indentfirst}
\usepackage[english, russian]{babel}
\usepackage[hidelinks]{hyperref}

\setmainfont{Times New Roman}
\input{./frames.tex}
\input{./toc.tex}
\input{./titlestyle.tex}
\input{./constants.tex}
\input{./commands.tex}
%\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\geometry{top = 15mm, left = 25mm, right = 10mm, bottom = 15mm}

\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{mainframe} {
    \fancyhf{}
    \fancyhead[L]{
        \mainframe
        {\tpga}
        {Кафедра ЭВМ Группа ИВТ-41}{
        \topic
        }
        {\authori}
        {Долженкова}
        {Скворцов}
        {Долженкова}
        {\thepage}
        {\pageref{lastpage}}
    }

}
\fancypagestyle{pageframe} {
    \fancyhf{}
    \fancyhead[L]{
        \pageframe
        {\tpga}
        {\thepage}
    }
}

\onehalfspacing
\setlength{\parindent}{12.5mm}


\sloppy


\begin{document}
\renewcommand{\contentsname}{\hfill Содержание \hfill}
\Large
\pagestyle{empty}
\include{pages/title.tex}

\include{pages/abstract.tex}

\addtolength{\textheight}{-40mm}
\tocloftpagestyle{mainframe}
\pagestyle{pageframe}
\addtolength{\textheight}{+25mm}
\tableofcontents\newpage

\input{pages/content.tex}
\label{lastpage}

\end{document}
